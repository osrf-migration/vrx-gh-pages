{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/125285709.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/vrx/diff/osrf/vrx:8b5fb44cee5f..9cf21d7c5c09?path=wamv_gazebo%2Furdf%2Fsensors%2Fwamv_gps.xacro"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-125285709"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "It seems that having `0 0 0` for  an axis produces NaN in joint\\_state\\_publisher. It was fixed when I switched one of the zeros to a one.", "markup": "markdown", "html": "<p>It seems that having <code>0 0 0</code> for  an axis produces NaN in joint_state_publisher. It was fixed when I switched one of the zeros to a one.</p>", "type": "rendered"}, "created_on": "2019-11-18T23:23:05.931865+00:00", "user": {"display_name": "Kevin Allen", "uuid": "{29f672ad-72f4-434e-bb0e-c6f2f69974f2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B29f672ad-72f4-434e-bb0e-c6f2f69974f2%7D"}, "html": {"href": "https://bitbucket.org/%7B29f672ad-72f4-434e-bb0e-c6f2f69974f2%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/355d0415f6040ffb168f44275ac2ee2fd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsKA-1.png"}}, "nickname": "kev-the-dev", "type": "user", "account_id": "5b04a6cf8a69f52b3ba2e5db"}, "inline": {"to": 28, "from": null, "path": "wamv_gazebo/urdf/sensors/wamv_gps.xacro"}, "updated_on": "2019-11-18T23:23:05.940075+00:00", "type": "pullrequest_comment", "id": 125285709}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/125286160.json"}, "code": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/vrx/diff/osrf/vrx:4cf9007d689d..08b803e81819?path=wamv_gazebo%2Furdf%2Fsensors%2Fwamv_gps.xacro"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-125286160"}}, "parent": {"id": 125285709, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/125285709.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-125285709"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "Good to know. Updated in 4cf9007. Feel free to approve the PR if it fixes the issue please.", "markup": "markdown", "html": "<p>Good to know. Updated in <a href=\"#!/osrf/vrx/commits/4cf9007\" rel=\"nofollow\" class=\"ap-connect-link\">4cf9007</a>. Feel free to approve the PR if it fixes the issue please.</p>", "type": "rendered"}, "created_on": "2019-11-18T23:29:51.534444+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "inline": {"to": 28, "from": null, "path": "wamv_gazebo/urdf/sensors/wamv_gps.xacro"}, "updated_on": "2019-11-18T23:29:51.540788+00:00", "type": "pullrequest_comment", "id": 125286160}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/125287220.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-125287220"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "It does seem that the measurements are being reported at the pose they should be now. However, it seems the latency introduced by joint\\_state\\_publisher or something else if causing instability now. UF does not have time to get our system working with this patch, and I doubt other teams do either", "markup": "markdown", "html": "<p>It does seem that the measurements are being reported at the pose they should be now. However, it seems the latency introduced by joint_state_publisher or something else if causing instability now. UF does not have time to get our system working with this patch, and I doubt other teams do either</p>", "type": "rendered"}, "created_on": "2019-11-18T23:45:08.083316+00:00", "user": {"display_name": "Kevin Allen", "uuid": "{29f672ad-72f4-434e-bb0e-c6f2f69974f2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B29f672ad-72f4-434e-bb0e-c6f2f69974f2%7D"}, "html": {"href": "https://bitbucket.org/%7B29f672ad-72f4-434e-bb0e-c6f2f69974f2%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/355d0415f6040ffb168f44275ac2ee2fd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsKA-1.png"}}, "nickname": "kev-the-dev", "type": "user", "account_id": "5b04a6cf8a69f52b3ba2e5db"}, "updated_on": "2019-11-18T23:45:08.090727+00:00", "type": "pullrequest_comment", "id": 125287220}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/125287574.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-125287574"}}, "parent": {"id": 125287220, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/125287220.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-125287220"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "Just to clarify, we\u2019re still discussing if this patch should be merged and used during the phase 3. What we\u2019re trying to figure out for now is whether this patch is enough to fix the issue.", "markup": "markdown", "html": "<p>Just to clarify, we\u2019re still discussing if this patch should be merged and used during the phase 3. What we\u2019re trying to figure out for now is whether this patch is enough to fix the issue.</p>", "type": "rendered"}, "created_on": "2019-11-18T23:50:32.075546+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": "2019-11-18T23:50:32.085602+00:00", "type": "pullrequest_comment", "id": 125287574}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/125287732.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-125287732"}}, "parent": {"id": 125287574, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/125287574.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-125287574"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "Looks to me like it fixes the issue discussed, but I don\u2019t have time to verify in depth. The steps I listed to reproduce in #188 would be a good way to verify. Thanks for the quick fix", "markup": "markdown", "html": "<p>Looks to me like it fixes the issue discussed, but I don\u2019t have time to verify in depth. The steps I listed to reproduce in <a href=\"#!/osrf/vrx/issues/188/gps-imu-are-measured-from-the-wrong-pose\" rel=\"nofollow\" title=\"GPS/IMU are measured from the wrong pose\" class=\"ap-connect-link\"><s>#188</s></a> would be a good way to verify. Thanks for the quick fix</p>", "type": "rendered"}, "created_on": "2019-11-18T23:52:40.598765+00:00", "user": {"display_name": "Kevin Allen", "uuid": "{29f672ad-72f4-434e-bb0e-c6f2f69974f2}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B29f672ad-72f4-434e-bb0e-c6f2f69974f2%7D"}, "html": {"href": "https://bitbucket.org/%7B29f672ad-72f4-434e-bb0e-c6f2f69974f2%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/355d0415f6040ffb168f44275ac2ee2fd=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsKA-1.png"}}, "nickname": "kev-the-dev", "type": "user", "account_id": "5b04a6cf8a69f52b3ba2e5db"}, "updated_on": "2019-11-18T23:52:40.605895+00:00", "type": "pullrequest_comment", "id": 125287732}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/137841311.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-137841311"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "Ashamed that it took so long to get to this, but feels nice to run VRX again after a break!\n\nI tested along the lines that Kevin suggested in the reporting issue \\(details below\\).  I could verify that moving the pose of the GPS and IMU had expected results with one exception - the GPS reported altitude does not agree with what I expected.  I set the origin of the revolute joint to z = 100, but the GPS fix has an altitude close to 200.  See === Verify vert. distance. section below.\n\n@{557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd} Any clue on the altitude discrepancy?\n\n\u200c\n\n---\n\n## Config A\\) Check default step\n\n* roslaunch vrx\\_gazebo vrx.launch\n* rostopic echo /wamv/sensors/gps/gps/fix yields\n\n```\nlatitude: 21.3109379275\nlongitude: -157.888570247\naltitude: 2.48590402649\n```\n\n* rostopic echo /wamv/sensors/imu/imu/data yields\n\n```\nheader: \n  seq: 1077\n  stamp: \n    secs: 71\n    nsecs: 867000000\n  frame_id: \"wamv/imu_wamv_link\"\norientation: \n  x: -0.00794067821936\n  y: -0.00241581306909\n  z: -0.981803397012\n  w: 0.189718736798\norientation_covariance: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\nangular_velocity: \n  x: -0.00101142008712\n  y: -0.00408081303609\n  z: 1.41976630001e-05\nangular_velocity_covariance: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\nlinear_acceleration: \n  x: 0.196233921458\n  y: 0.0199191218194\n  z: 9.81967269712\nlinear_acceleration_covariance: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n```\n\n== Config B\\) Change sensor locations and retest\n\n* Edit wamv\\_gazebo/urdf/wamv\\_gazebo.urdf.xacro to translate GPS and rotate IMU\n\n```\n    \t<!-- Add simulated GPS -->\n      <xacro:wamv_gps name=\"gps_wamv\" x=\"-0.85\" y=\"100.0\" z=\"100.0\" />\n\t\t\t\n      <!-- Add Simulated IMU -->\n      <xacro:wamv_imu name=\"imu_wamv\" y=\"-0.2\" Y=\"3.14159\"/>\n```\n\n* Note - can't put GPS out at y=1000 because it has a non-zero mass which causes the vessel to be unstable!\n* Remake and relaunch\n* Echo GPS fix\n\n```\nlatitude: 21.3100789254\nlongitude: -157.888191105\naltitude: 196.85366178\nposition_covariance: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\nposition_covariance_type: 2\n```\n\n* Echo IMU data\n\n```\norientation: \n  x: -0.00162243659762\n  y: 0.0117598847966\n  z: 0.184937594048\n  w: 0.982678563477\norientation_covariance: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\nangular_velocity: \n  x: 0.00351846188189\n  y: -0.00400872612212\n  z: 0.00430841915039\nangular_velocity_covariance: [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\nlinear_acceleration: \n  x: -0.269482707697\n  y: -0.0398469741012\n  z: 9.78778357931\n```\n\n== Verify\n\n=== Verify horiz. distance\n\nUse haversine \\([https://github.com/mapado/haversine\\)](https://github.com/mapado/haversine)) to check 2D distance\n\n```\nimport haversine\np1 = (21.3109379275,-157.888570247)\np2 = (21.3100789254,-157.888191105)\nprint haversine.haversine(p1,p2,unit=haversine.Unit.METERS)\n```\n\nyields\n\n```\nIn [3]: run -i ex.py\n103.276681408\n```\n\nSeems valid.\n\n=== Verify vert. distance.\n\nExpect altitude in GPS fix for  configuration B to be ~100 m.  Reported altitude is more like 200 m.  Not sure why?\n\nAlso tried with a simpler GPS joint:\n\n```\n\t<!-- Add simulated GPS -->\n      <xacro:wamv_gps name=\"gps_wamv\" x=\"-0.85\" y=\"0.0\" z=\"100.0\" />\n```\n\nSame result - expected altitude of ~100, but received altitude of ~200.\n\n== Verify orientation\n\n```\nfrom tf.transformations import euler_from_quaternion\n# Quaternion in order of x, y, z, w\nq = (-0.00794067821936,\n     -0.00241581306909,\n     -0.981803397012,\n     0.189718736798)\nprint euler_from_quaternion(q)\n\nq = (-0.00162243659762,\n     0.0117598847966,\n     0.184937594048,\n     0.982678563477)\nprint euler_from_quaternion(q)\n```\n\nyields\n\n```\nIn [1]: run -i q2e.py\n(0.0017309528373354386, -0.01650976971627963, -2.7598422849744475)\n(0.0011613490803237202, 0.02371469518148903, 0.3720570154418935)\n```\n\nSeems about right.", "markup": "markdown", "html": "<p>Ashamed that it took so long to get to this, but feels nice to run VRX again after a break!</p>\n<p>I tested along the lines that Kevin suggested in the reporting issue (details below).  I could verify that moving the pose of the GPS and IMU had expected results with one exception - the GPS reported altitude does not agree with what I expected.  I set the origin of the revolute joint to z = 100, but the GPS fix has an altitude close to 200.  See === Verify vert. distance. section below.</p>\n<p><span class=\"ap-mention\" data-atlassian-id=\"557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd\">@Carlos Ag\u00fcero</span> Any clue on the altitude discrepancy?</p>\n<p>\u200c</p>\n<hr />\n<h2 id=\"markdown-header-config-a41-check-default-step\">Config A) Check default step</h2>\n<ul>\n<li>roslaunch vrx_gazebo vrx.launch</li>\n<li>rostopic echo /wamv/sensors/gps/gps/fix yields</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">latitude</span><span class=\"o\">:</span> <span class=\"mf\">21.3109379275</span>\n<span class=\"n\">longitude</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">157.888570247</span>\n<span class=\"n\">altitude</span><span class=\"o\">:</span> <span class=\"mf\">2.48590402649</span>\n</pre></div>\n\n\n<ul>\n<li>rostopic echo /wamv/sensors/imu/imu/data yields</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">header</span><span class=\"o\">:</span> \n  <span class=\"n\">seq</span><span class=\"o\">:</span> <span class=\"mi\">1077</span>\n  <span class=\"n\">stamp</span><span class=\"o\">:</span> \n    <span class=\"n\">secs</span><span class=\"o\">:</span> <span class=\"mi\">71</span>\n    <span class=\"n\">nsecs</span><span class=\"o\">:</span> <span class=\"mi\">867000000</span>\n  <span class=\"n\">frame_id</span><span class=\"o\">:</span> <span class=\"s2\">&quot;wamv/imu_wamv_link&quot;</span>\n<span class=\"n\">orientation</span><span class=\"o\">:</span> \n  <span class=\"n\">x</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.00794067821936</span>\n  <span class=\"n\">y</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.00241581306909</span>\n  <span class=\"n\">z</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.981803397012</span>\n  <span class=\"n\">w</span><span class=\"o\">:</span> <span class=\"mf\">0.189718736798</span>\n<span class=\"n\">orientation_covariance</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">]</span>\n<span class=\"n\">angular_velocity</span><span class=\"o\">:</span> \n  <span class=\"n\">x</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.00101142008712</span>\n  <span class=\"n\">y</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.00408081303609</span>\n  <span class=\"n\">z</span><span class=\"o\">:</span> <span class=\"mf\">1.41976630001</span><span class=\"n\">e</span><span class=\"o\">-</span><span class=\"mi\">05</span>\n<span class=\"n\">angular_velocity_covariance</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">]</span>\n<span class=\"n\">linear_acceleration</span><span class=\"o\">:</span> \n  <span class=\"n\">x</span><span class=\"o\">:</span> <span class=\"mf\">0.196233921458</span>\n  <span class=\"n\">y</span><span class=\"o\">:</span> <span class=\"mf\">0.0199191218194</span>\n  <span class=\"n\">z</span><span class=\"o\">:</span> <span class=\"mf\">9.81967269712</span>\n<span class=\"n\">linear_acceleration_covariance</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">]</span>\n</pre></div>\n\n\n<p>== Config B) Change sensor locations and retest</p>\n<ul>\n<li>Edit wamv_gazebo/urdf/wamv_gazebo.urdf.xacro to translate GPS and rotate IMU</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span>        &lt;!-- Add simulated GPS --&gt;\n      &lt;xacro:wamv_gps name=&quot;gps_wamv&quot; x=&quot;-0.85&quot; y=&quot;100.0&quot; z=&quot;100.0&quot; /&gt;\n\n      &lt;!-- Add Simulated IMU --&gt;\n      &lt;xacro:wamv_imu name=&quot;imu_wamv&quot; y=&quot;-0.2&quot; Y=&quot;3.14159&quot;/&gt;\n</pre></div>\n\n\n<ul>\n<li>Note - can't put GPS out at y=1000 because it has a non-zero mass which causes the vessel to be unstable!</li>\n<li>Remake and relaunch</li>\n<li>Echo GPS fix</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">latitude</span><span class=\"o\">:</span> <span class=\"mf\">21.3100789254</span>\n<span class=\"n\">longitude</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">157.888191105</span>\n<span class=\"n\">altitude</span><span class=\"o\">:</span> <span class=\"mf\">196.85366178</span>\n<span class=\"n\">position_covariance</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">]</span>\n<span class=\"n\">position_covariance_type</span><span class=\"o\">:</span> <span class=\"mi\">2</span>\n</pre></div>\n\n\n<ul>\n<li>Echo IMU data</li>\n</ul>\n<div class=\"codehilite\"><pre><span></span><span class=\"n\">orientation</span><span class=\"o\">:</span> \n  <span class=\"n\">x</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.00162243659762</span>\n  <span class=\"n\">y</span><span class=\"o\">:</span> <span class=\"mf\">0.0117598847966</span>\n  <span class=\"n\">z</span><span class=\"o\">:</span> <span class=\"mf\">0.184937594048</span>\n  <span class=\"n\">w</span><span class=\"o\">:</span> <span class=\"mf\">0.982678563477</span>\n<span class=\"n\">orientation_covariance</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">]</span>\n<span class=\"n\">angular_velocity</span><span class=\"o\">:</span> \n  <span class=\"n\">x</span><span class=\"o\">:</span> <span class=\"mf\">0.00351846188189</span>\n  <span class=\"n\">y</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.00400872612212</span>\n  <span class=\"n\">z</span><span class=\"o\">:</span> <span class=\"mf\">0.00430841915039</span>\n<span class=\"n\">angular_velocity_covariance</span><span class=\"o\">:</span> <span class=\"o\">[</span><span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">,</span> <span class=\"mf\">0.0</span><span class=\"o\">]</span>\n<span class=\"n\">linear_acceleration</span><span class=\"o\">:</span> \n  <span class=\"n\">x</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.269482707697</span>\n  <span class=\"n\">y</span><span class=\"o\">:</span> <span class=\"o\">-</span><span class=\"mf\">0.0398469741012</span>\n  <span class=\"n\">z</span><span class=\"o\">:</span> <span class=\"mf\">9.78778357931</span>\n</pre></div>\n\n\n<p>== Verify</p>\n<p>=== Verify horiz. distance</p>\n<p>Use haversine (<a data-is-external-link=\"true\" href=\"https://github.com/mapado/haversine\" rel=\"nofollow\">https://github.com/mapado/haversine)</a>) to check 2D distance</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">haversine</span>\n<span class=\"n\">p1</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mf\">21.3109379275</span><span class=\"p\">,</span><span class=\"o\">-</span><span class=\"mf\">157.888570247</span><span class=\"p\">)</span>\n<span class=\"n\">p2</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"mf\">21.3100789254</span><span class=\"p\">,</span><span class=\"o\">-</span><span class=\"mf\">157.888191105</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"n\">haversine</span><span class=\"o\">.</span><span class=\"n\">haversine</span><span class=\"p\">(</span><span class=\"n\">p1</span><span class=\"p\">,</span><span class=\"n\">p2</span><span class=\"p\">,</span><span class=\"n\">unit</span><span class=\"o\">=</span><span class=\"n\">haversine</span><span class=\"o\">.</span><span class=\"n\">Unit</span><span class=\"o\">.</span><span class=\"n\">METERS</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>yields</p>\n<div class=\"codehilite\"><pre><span></span>In [3]: run -i ex.py\n103.276681408\n</pre></div>\n\n\n<p>Seems valid.</p>\n<p>=== Verify vert. distance.</p>\n<p>Expect altitude in GPS fix for  configuration B to be ~100 m.  Reported altitude is more like 200 m.  Not sure why?</p>\n<p>Also tried with a simpler GPS joint:</p>\n<div class=\"codehilite\"><pre><span></span>    &lt;!-- Add simulated GPS --&gt;\n      &lt;xacro:wamv_gps name=&quot;gps_wamv&quot; x=&quot;-0.85&quot; y=&quot;0.0&quot; z=&quot;100.0&quot; /&gt;\n</pre></div>\n\n\n<p>Same result - expected altitude of ~100, but received altitude of ~200.</p>\n<p>== Verify orientation</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"kn\">from</span> <span class=\"nn\">tf.transformations</span> <span class=\"kn\">import</span> <span class=\"n\">euler_from_quaternion</span>\n<span class=\"c1\"># Quaternion in order of x, y, z, w</span>\n<span class=\"n\">q</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.00794067821936</span><span class=\"p\">,</span>\n     <span class=\"o\">-</span><span class=\"mf\">0.00241581306909</span><span class=\"p\">,</span>\n     <span class=\"o\">-</span><span class=\"mf\">0.981803397012</span><span class=\"p\">,</span>\n     <span class=\"mf\">0.189718736798</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"n\">euler_from_quaternion</span><span class=\"p\">(</span><span class=\"n\">q</span><span class=\"p\">)</span>\n\n<span class=\"n\">q</span> <span class=\"o\">=</span> <span class=\"p\">(</span><span class=\"o\">-</span><span class=\"mf\">0.00162243659762</span><span class=\"p\">,</span>\n     <span class=\"mf\">0.0117598847966</span><span class=\"p\">,</span>\n     <span class=\"mf\">0.184937594048</span><span class=\"p\">,</span>\n     <span class=\"mf\">0.982678563477</span><span class=\"p\">)</span>\n<span class=\"k\">print</span> <span class=\"n\">euler_from_quaternion</span><span class=\"p\">(</span><span class=\"n\">q</span><span class=\"p\">)</span>\n</pre></div>\n\n\n<p>yields</p>\n<div class=\"codehilite\"><pre><span></span>In [1]: run -i q2e.py\n(0.0017309528373354386, -0.01650976971627963, -2.7598422849744475)\n(0.0011613490803237202, 0.02371469518148903, 0.3720570154418935)\n</pre></div>\n\n\n<p>Seems about right.</p>", "type": "rendered"}, "created_on": "2020-02-27T16:41:21.588349+00:00", "user": {"display_name": "Brian Bingham", "uuid": "{9cdea257-248f-486e-8858-49d8485a916f}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9cdea257-248f-486e-8858-49d8485a916f%7D"}, "html": {"href": "https://bitbucket.org/%7B9cdea257-248f-486e-8858-49d8485a916f%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1/7a690884-fc47-4bca-9c2b-baecee4d3dc9/128"}}, "nickname": "brian_bingham", "type": "user", "account_id": "557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1"}, "updated_on": "2020-02-27T16:41:21.602365+00:00", "type": "pullrequest_comment", "id": 137841311}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/138093443.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-138093443"}}, "parent": {"id": 137841311, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/137841311.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-137841311"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "Thanks for the analysis! I think the issue is that `referenceAltitude` was set to `z` but as far as I understand it should be `0`. I changed it in [5e541de](#!/osrf/vrx/commits/5e541de3f4fd9840a52d534cd7970790fe8b0550?at=default) and seems to work.  Could you give it another try?", "markup": "markdown", "html": "<p>Thanks for the analysis! I think the issue is that <code>referenceAltitude</code> was set to <code>z</code> but as far as I understand it should be <code>0</code>. I changed it in <a data-is-external-link=\"true\" href=\"#!/osrf/vrx/commits/5e541de3f4fd9840a52d534cd7970790fe8b0550?at=default\" rel=\"nofollow\">5e541de</a> and seems to work.  Could you give it another try?</p>", "type": "rendered"}, "created_on": "2020-03-01T16:25:02.837206+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": "2020-03-01T16:25:02.844895+00:00", "type": "pullrequest_comment", "id": 138093443}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/138708849.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-138708849"}}, "parent": {"id": 138093443, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/138093443.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-138093443"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "Nice catch - that does it!", "markup": "markdown", "html": "<p>Nice catch - that does it!</p>", "type": "rendered"}, "created_on": "2020-03-04T21:53:42.533936+00:00", "user": {"display_name": "Brian Bingham", "uuid": "{9cdea257-248f-486e-8858-49d8485a916f}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9cdea257-248f-486e-8858-49d8485a916f%7D"}, "html": {"href": "https://bitbucket.org/%7B9cdea257-248f-486e-8858-49d8485a916f%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1/7a690884-fc47-4bca-9c2b-baecee4d3dc9/128"}}, "nickname": "brian_bingham", "type": "user", "account_id": "557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1"}, "updated_on": "2020-03-04T21:53:42.542277+00:00", "type": "pullrequest_comment", "id": 138708849}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/137841684.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-137841684"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "@caguero For posterity, is there documentation we can link to on the issue of \u201cWhen fixed joints are involved, the URDF to SDF conversion removes the intermediate links.\u201d  I would have never found that subtle bug.", "markup": "markdown", "html": "<p>@caguero For posterity, is there documentation we can link to on the issue of \u201cWhen fixed joints are involved, the URDF to SDF conversion removes the intermediate links.\u201d  I would have never found that subtle bug.</p>", "type": "rendered"}, "created_on": "2020-02-27T16:43:07.655271+00:00", "user": {"display_name": "Brian Bingham", "uuid": "{9cdea257-248f-486e-8858-49d8485a916f}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9cdea257-248f-486e-8858-49d8485a916f%7D"}, "html": {"href": "https://bitbucket.org/%7B9cdea257-248f-486e-8858-49d8485a916f%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1/7a690884-fc47-4bca-9c2b-baecee4d3dc9/128"}}, "nickname": "brian_bingham", "type": "user", "account_id": "557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1"}, "updated_on": "2020-02-27T16:43:07.674355+00:00", "type": "pullrequest_comment", "id": 137841684}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/138236295.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-138236295"}}, "parent": {"id": 137841684, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/137841684.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-137841684"}}, "depth": 1}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "As far as I know this aspect of the conversion from URDF to SDF is not documented. It has appeared a few times in different issues. [Here\u2019s](http://answers.gazebosim.org/question/1321/a-correct-way-to-implement-fixed-joint/) an example \\(a bit old\\).", "markup": "markdown", "html": "<p>As far as I know this aspect of the conversion from URDF to SDF is not documented. It has appeared a few times in different issues. <a data-is-external-link=\"true\" href=\"http://answers.gazebosim.org/question/1321/a-correct-way-to-implement-fixed-joint/\" rel=\"nofollow\">Here\u2019s</a> an example (a bit old).</p>", "type": "rendered"}, "created_on": "2020-03-02T16:20:13.484291+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": "2020-03-02T16:20:13.495838+00:00", "type": "pullrequest_comment", "id": 138236295}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/138708984.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-138708984"}}, "parent": {"id": 138236295, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/138236295.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-138236295"}}, "depth": 2}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "That will remind me for next time - thank you.", "markup": "markdown", "html": "<p>That will remind me for next time - thank you.</p>", "type": "rendered"}, "created_on": "2020-03-04T21:54:39.658344+00:00", "user": {"display_name": "Brian Bingham", "uuid": "{9cdea257-248f-486e-8858-49d8485a916f}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9cdea257-248f-486e-8858-49d8485a916f%7D"}, "html": {"href": "https://bitbucket.org/%7B9cdea257-248f-486e-8858-49d8485a916f%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1/7a690884-fc47-4bca-9c2b-baecee4d3dc9/128"}}, "nickname": "brian_bingham", "type": "user", "account_id": "557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1"}, "updated_on": "2020-03-04T21:54:39.673923+00:00", "type": "pullrequest_comment", "id": 138708984}, {"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216/comments/144547003.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216/_/diff#comment-144547003"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 216, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/216.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/216"}}, "title": "Fix issue #188"}, "content": {"raw": "Hi guys, thanks for the amazing fix! I noticed similar issues while working with the IMU plugin while using fixed joints. Using revolute joints fixed the issue \\(mostly\\) or so I thought as I have discovered a bug.  Rotations in yaw for the IMU plugin work perfectly with this new fix \\(the fixed joint method reports inaccurate readings\\), however, rotations in pitch or roll result in incorrect readings from the IMU. For example,  using `<xacro:wamv_imu name=\"imu_wamv\" y=\"-0.2\" R=\"3.14159\"/>` where the roll is set to 180 degrees instead of yaw, the raw readings reported by the IMU plugin is \\(r,p,y\\) =  \\(0,0, 2.76\\) when the correct readings are supposed to be \\(r,p,y\\) = \\(0,0,-2.76\\) \\(notice the yaw has been flipped/inverted\\). This does not make sense since physical IMU has been flipped 180 degrees. Setting an arbitary value of rpy in the macro results in even more disastrous results.   \n  \nExample: `<xacro:wamv_imu name=\"imu_wamv\" y=\"-0.2\" R=\"1\" P=\"1\" Y=\"1\"/>`\n\nDo you guys know why this is happening? Although I understand this is a strange requirement for teams to mount their sensors in weird positions \\(roll, pitch\\).  Thanks.", "markup": "markdown", "html": "<p>Hi guys, thanks for the amazing fix! I noticed similar issues while working with the IMU plugin while using fixed joints. Using revolute joints fixed the issue (mostly) or so I thought as I have discovered a bug.  Rotations in yaw for the IMU plugin work perfectly with this new fix (the fixed joint method reports inaccurate readings), however, rotations in pitch or roll result in incorrect readings from the IMU. For example,  using <code>&lt;xacro:wamv_imu name=\"imu_wamv\" y=\"-0.2\" R=\"3.14159\"/&gt;</code> where the roll is set to 180 degrees instead of yaw, the raw readings reported by the IMU plugin is (r,p,y) =  (0,0, 2.76) when the correct readings are supposed to be (r,p,y) = (0,0,-2.76) (notice the yaw has been flipped/inverted). This does not make sense since physical IMU has been flipped 180 degrees. Setting an arbitary value of rpy in the macro results in even more disastrous results.   </p>\n<p>Example: <code>&lt;xacro:wamv_imu name=\"imu_wamv\" y=\"-0.2\" R=\"1\" P=\"1\" Y=\"1\"/&gt;</code></p>\n<p>Do you guys know why this is happening? Although I understand this is a strange requirement for teams to mount their sensors in weird positions (roll, pitch).  Thanks.</p>", "type": "rendered"}, "created_on": "2020-04-09T15:51:00.578090+00:00", "user": {"display_name": "Hashir Zahir", "uuid": "{0033cdb9-ea6e-4c6a-a9ad-d462a485643d}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B0033cdb9-ea6e-4c6a-a9ad-d462a485643d%7D"}, "html": {"href": "https://bitbucket.org/%7B0033cdb9-ea6e-4c6a-a9ad-d462a485643d%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/3c71628af17207fad1dd0ea6280b41f1d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsHZ-5.png"}}, "nickname": "hzahir", "type": "user", "account_id": "557058:6b6463b7-2835-47c7-8c22-fdef36e9e325"}, "updated_on": "2020-04-09T15:51:00.581220+00:00", "type": "pullrequest_comment", "id": 144547003}], "page": 1, "size": 12}
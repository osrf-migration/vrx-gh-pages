{"links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/148/comments/109717797.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/148/_/diff#comment-109717797"}}, "parent": {"id": 109717290, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/148/comments/109717290.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/148/_/diff#comment-109717290"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 148, "links": {"self": {"href": "data/repositories/osrf/vrx/pullrequests/148.json"}, "html": {"href": "#!/osrf/vrx/pull-requests/148"}}, "title": "Issue#139 gazebo ros shutdown"}, "content": {"raw": "I like this idea. Very clear and works. I think we need to also add UpdateTaskMessage\\(\\) before publishing, or else the taskMsg would be the same as the previous one. That way, as soon as it is finished, it will update task message, publish, then exit.\n\n```\n//////////////////////////////////////////////////\nvoid ScoringPlugin::PublishStats()\n{\n  this->UpdateTaskMessage();\n\n  // We publish stats at 1Hz.\n  if (this->currentTime - this->lastStatsSent >= gazebo::common::Time(1, 0))\n  {\n    this->taskPub.publish(this->taskMsg);\n    this->lastStatsSent = this->currentTime;\n  }\n}\n```\n\nEssentially, I think we want this code to remain as is to always publish at 1 Hz, but when OnFinished is called, run this without the if statement.", "markup": "markdown", "html": "<p>I like this idea. Very clear and works. I think we need to also add UpdateTaskMessage() before publishing, or else the taskMsg would be the same as the previous one. That way, as soon as it is finished, it will update task message, publish, then exit.</p>\n<div class=\"codehilite\"><pre><span></span>//////////////////////////////////////////////////\nvoid ScoringPlugin::PublishStats()\n{\n  this-&gt;UpdateTaskMessage();\n\n  // We publish stats at 1Hz.\n  if (this-&gt;currentTime - this-&gt;lastStatsSent &gt;= gazebo::common::Time(1, 0))\n  {\n    this-&gt;taskPub.publish(this-&gt;taskMsg);\n    this-&gt;lastStatsSent = this-&gt;currentTime;\n  }\n}\n</pre></div>\n\n\n<p>Essentially, I think we want this code to remain as is to always publish at 1 Hz, but when OnFinished is called, run this without the if statement.</p>", "type": "rendered"}, "created_on": "2019-07-18T00:07:21.250025+00:00", "user": {"display_name": "Tyler Lum", "uuid": "{305d9368-23ba-4f72-b1d4-7d17d2a062d8}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B305d9368-23ba-4f72-b1d4-7d17d2a062d8%7D"}, "html": {"href": "https://bitbucket.org/%7B305d9368-23ba-4f72-b1d4-7d17d2a062d8%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/5b96b66385af94340e7cabce/b8bb780f-62b7-47f8-9d03-ee65c7d17ad4/128"}}, "nickname": "tylerlum", "type": "user", "account_id": "5b96b66385af94340e7cabce"}, "updated_on": "2019-07-18T00:08:34.989141+00:00", "type": "pullrequest_comment", "id": 109717797}
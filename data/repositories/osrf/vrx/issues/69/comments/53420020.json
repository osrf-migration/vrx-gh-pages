{"links": {"self": {"href": "data/repositories/osrf/vrx/issues/69/comments/53420020.json"}, "html": {"href": "#!/osrf/vrx/issues/69#comment-53420020"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/vrx/issues/69.json"}}, "type": "issue", "id": 69, "repository": {"links": {"self": {"href": "data/repositories/osrf/vrx.json"}, "html": {"href": "#!/osrf/vrx"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e278ca38-7edb-4e62-b785-46dff5617d98}ts=2274605"}}, "type": "repository", "name": "vrx", "full_name": "osrf/vrx", "uuid": "{e278ca38-7edb-4e62-b785-46dff5617d98}"}, "title": "Configure osrf/vrx Dockerhub repository"}, "content": {"raw": "The following steps will produce test accounts in Bitbucket and Dockerhub suitable for troubleshooting the autobuild configuration set up between our OpenSourceRoboticsFoundation OSRF/Simulation /vrx repository on Bitbucket and our osrf/vrx repository on Docker Hub.\n\n## From BitBucket:\n\nFirst create a new \"machine user\" account:\n\n* Procure a new / unused email address.\n* Use the address to create a new account on Bitbucket. Ex: vrxmachineuser\n* Generate ssh keys for the machine user account and add them.\n\nNext, log in to Bitbucket with any other account and set up a test repository as follows:\n\n* Create a new Team. Ex: vrxTestTeam\n* Create a new Project belonging to the team. Ex: autobuildTesting\n* Create a new repository under the project. Ex: autobuildme\n* Create a new group. Ex: build.\n\n    * Under the Settings page for the team, navigate to User groups.\n    * Select Add group.\n    * Enter \"build\" in the name field.\n    * Leave Default repository access set to None.\n    * _**Select the checkbox next to Administer Team.**_ This will cause \"Create Repositories\" and \"Receive notifications sent to team admins\" to be checked also.\n    \n* Once the group is created, select Add member to invite the machine user to the group.\n* Navigate to the new repository and select Settings.\n* Under User and group access use the interface to add the build group to the repository with admin access.\n* Log out of Bitbucket and log back in with the machine user account. Accept the invitation to the join the team. Remain logged in to Bitbucket as the machine user while performing the Docker Hub configuration, below.\n\n## From Docker Hub:\n\nOpen a new tab in your browser, navigate to Docker Hub and log in with any account.\n\n* Create an organization. Ex: vrxHubAutobuilders. This will put your current account in the owners group of this organization, which is necessary for linking with the Bitbucket account we just created.\n* Create a repository under the organization. Ex: autobuilt. Under Visibility, choose Public.\n* Navigate to the main page of the repository, select Manage Repository to reveal the admin interface, and select the Builds tab.\n* Click on the box for \"Link to Bitbucket.\" This will redirect you to the Linked Accounts portion of the Account Settings page for the new organization.\n* _**Before proceeding, make sure you are either logged in to Bitbucket as the machine user or logged out of Bitbucket in all browser tabs.**_ Otherwise Docker Hub will prompt you to authorize the wrong account by default.\n* Click \"Connect\" next to Bitbucket. You will be redirected to the Bitbucket website.\n* If prompted for credentials, log in as the machine user.\n* Authorize the request.\n* Navigate back to the repository page in Docker Hub and select the Builds tab again.\n* Select \"Link to Bitbucket\" _**a second time**_ \\(it should now say \"Connected\"\\). This will redirect you to the build configurations page. \\(Note: do not select the Configure Automatic Builds button, which will redirect to an error message.\\)\n* In the dropdown for source repository, under \"Select Organization,\" choose the team you created in the Bitbucket section \\(vrxTestTeam\\).\n* In the \"Select repository\" drop down, verify that you can see the option to select the test repository.\n* Once the above is verified, cancel out. The purpose of this is so we can verify that build configuration works for members of the admin team once the account link has been established.\n* Navigate to Organizations and select the newly created vrxHubAutobuilders organization.\n* Select Create Team and add a new team. Ex: administrators.\n* Under the Users tab add a new user. Invite any other Docker Hub user you have credentials for \\(or pause here to create a new DockerHub user. Ex: autobuildAdmin\\).\n* Click on the team and select the permissions tab. User the interface to give team members admin permissions for the test repository \\(autobuilt\\).\n* Log out of the current account and log back in as the new user \\(autobuildAdmin\\).\n* Navigate back to the repository and verify that you can access the Builds tab.\n* Select Link to Bitbucket and verify that you can again choose the necessary Organization and repository through the link to the machine user account.\n\nYou can now create and test autobuild configurations and triggers as needed using a setup that's comparable to osrf/vrx repository structure.", "markup": "markdown", "html": "<p>The following steps will produce test accounts in Bitbucket and Dockerhub suitable for troubleshooting the autobuild configuration set up between our OpenSourceRoboticsFoundation OSRF/Simulation /vrx repository on Bitbucket and our <a href=\"#!/osrf/vrx\" rel=\"nofollow\" class=\"ap-connect-link\">osrf/vrx</a> repository on Docker Hub.</p>\n<h2 id=\"markdown-header-from-bitbucket\">From BitBucket:</h2>\n<p>First create a new \"machine user\" account:</p>\n<ul>\n<li>Procure a new / unused email address.</li>\n<li>Use the address to create a new account on Bitbucket. Ex: vrxmachineuser</li>\n<li>Generate ssh keys for the machine user account and add them.</li>\n</ul>\n<p>Next, log in to Bitbucket with any other account and set up a test repository as follows:</p>\n<ul>\n<li>Create a new Team. Ex: vrxTestTeam</li>\n<li>Create a new Project belonging to the team. Ex: autobuildTesting</li>\n<li>Create a new repository under the project. Ex: autobuildme</li>\n<li>\n<p>Create a new group. Ex: build.</p>\n<ul>\n<li>Under the Settings page for the team, navigate to User groups.</li>\n<li>Select Add group.</li>\n<li>Enter \"build\" in the name field.</li>\n<li>Leave Default repository access set to None.</li>\n<li><em><strong>Select the checkbox next to Administer Team.</strong></em> This will cause \"Create Repositories\" and \"Receive notifications sent to team admins\" to be checked also.</li>\n</ul>\n</li>\n<li>\n<p>Once the group is created, select Add member to invite the machine user to the group.</p>\n</li>\n<li>Navigate to the new repository and select Settings.</li>\n<li>Under User and group access use the interface to add the build group to the repository with admin access.</li>\n<li>Log out of Bitbucket and log back in with the machine user account. Accept the invitation to the join the team. Remain logged in to Bitbucket as the machine user while performing the Docker Hub configuration, below.</li>\n</ul>\n<h2 id=\"markdown-header-from-docker-hub\">From Docker Hub:</h2>\n<p>Open a new tab in your browser, navigate to Docker Hub and log in with any account.</p>\n<ul>\n<li>Create an organization. Ex: vrxHubAutobuilders. This will put your current account in the owners group of this organization, which is necessary for linking with the Bitbucket account we just created.</li>\n<li>Create a repository under the organization. Ex: autobuilt. Under Visibility, choose Public.</li>\n<li>Navigate to the main page of the repository, select Manage Repository to reveal the admin interface, and select the Builds tab.</li>\n<li>Click on the box for \"Link to Bitbucket.\" This will redirect you to the Linked Accounts portion of the Account Settings page for the new organization.</li>\n<li><em><strong>Before proceeding, make sure you are either logged in to Bitbucket as the machine user or logged out of Bitbucket in all browser tabs.</strong></em> Otherwise Docker Hub will prompt you to authorize the wrong account by default.</li>\n<li>Click \"Connect\" next to Bitbucket. You will be redirected to the Bitbucket website.</li>\n<li>If prompted for credentials, log in as the machine user.</li>\n<li>Authorize the request.</li>\n<li>Navigate back to the repository page in Docker Hub and select the Builds tab again.</li>\n<li>Select \"Link to Bitbucket\" <em><strong>a second time</strong></em> (it should now say \"Connected\"). This will redirect you to the build configurations page. (Note: do not select the Configure Automatic Builds button, which will redirect to an error message.)</li>\n<li>In the dropdown for source repository, under \"Select Organization,\" choose the team you created in the Bitbucket section (vrxTestTeam).</li>\n<li>In the \"Select repository\" drop down, verify that you can see the option to select the test repository.</li>\n<li>Once the above is verified, cancel out. The purpose of this is so we can verify that build configuration works for members of the admin team once the account link has been established.</li>\n<li>Navigate to Organizations and select the newly created vrxHubAutobuilders organization.</li>\n<li>Select Create Team and add a new team. Ex: administrators.</li>\n<li>Under the Users tab add a new user. Invite any other Docker Hub user you have credentials for (or pause here to create a new DockerHub user. Ex: autobuildAdmin).</li>\n<li>Click on the team and select the permissions tab. User the interface to give team members admin permissions for the test repository (autobuilt).</li>\n<li>Log out of the current account and log back in as the new user (autobuildAdmin).</li>\n<li>Navigate back to the repository and verify that you can access the Builds tab.</li>\n<li>Select Link to Bitbucket and verify that you can again choose the necessary Organization and repository through the link to the machine user account.</li>\n</ul>\n<p>You can now create and test autobuild configurations and triggers as needed using a setup that's comparable to <a href=\"#!/osrf/vrx\" rel=\"nofollow\" class=\"ap-connect-link\">osrf/vrx</a> repository structure.</p>", "type": "rendered"}, "created_on": "2019-08-15T02:28:32.739494+00:00", "user": {"display_name": "Michael McCarrin", "uuid": "{3c3f500d-bbf6-472c-b8f7-627e5eabc226}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B3c3f500d-bbf6-472c-b8f7-627e5eabc226%7D"}, "html": {"href": "https://bitbucket.org/%7B3c3f500d-bbf6-472c-b8f7-627e5eabc226%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/a50abc93a3175f92c79e7521dfe089c0d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsMM-0.png"}}, "nickname": "m1chaelm", "type": "user", "account_id": "5b2a9176467c9a09caa71ab1"}, "updated_on": null, "type": "issue_comment", "id": 53420020}
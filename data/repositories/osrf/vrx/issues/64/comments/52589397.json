{"links": {"self": {"href": "data/repositories/osrf/vrx/issues/64/comments/52589397.json"}, "html": {"href": "#!/osrf/vrx/issues/64#comment-52589397"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/vrx/issues/64.json"}}, "type": "issue", "id": 64, "repository": {"links": {"self": {"href": "data/repositories/osrf/vrx.json"}, "html": {"href": "#!/osrf/vrx"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e278ca38-7edb-4e62-b785-46dff5617d98}ts=2274605"}}, "type": "repository", "name": "vrx", "full_name": "osrf/vrx", "uuid": "{e278ca38-7edb-4e62-b785-46dff5617d98}"}, "title": "Possible frame error in simulated GPS velocity generation"}, "content": {"raw": "The issue with coordinate generation in the built in GPS sensor may be related to an issue with spherical coordinates.  The following gazebo answers post shows a possible issue in the conversion of local to spherical coordinates:\n\n[http://answers.gazebosim.org/question/13820/bug-in-sphericalcoordinatessphericalfromlocal/](http://answers.gazebosim.org/question/13820/bug-in-sphericalcoordinatessphericalfromlocal/)\n\nIn that post a test program that converts from local to spherical coordinates is used to test some simple values.  Positive x and y values generate negative longitudes and latitudes respectively, implying that the coordinates are being reversed during the transform.  I have tried the code sample, and my calculated values do seem to match those in the post.\n\nExamining the [linked source code](https://bitbucket.org/osrf/gazebo/src/48039241c95fcf879ef5861e5ca66efcd4f22e6c/gazebo/common/SphericalCoordinates.cc?at=default&fileviewer=file-view-default#SphericalCoordinates.cc-313), which shows the local to spherical transformation of both coordinates and velocities, the SphericalCoordinates class appears to start by reversing the sign of the x and y components.  This could be the source of the coordinate reversal.  Checking the ignition version of the code it seems identical, implying that later version of gazebo that use the ignition library are also likely to be affected.  \n\nRegards,\n\nJonathan.", "markup": "markdown", "html": "<p>The issue with coordinate generation in the built in GPS sensor may be related to an issue with spherical coordinates.  The following gazebo answers post shows a possible issue in the conversion of local to spherical coordinates:</p>\n<p><a data-is-external-link=\"true\" href=\"http://answers.gazebosim.org/question/13820/bug-in-sphericalcoordinatessphericalfromlocal/\" rel=\"nofollow\">http://answers.gazebosim.org/question/13820/bug-in-sphericalcoordinatessphericalfromlocal/</a></p>\n<p>In that post a test program that converts from local to spherical coordinates is used to test some simple values.  Positive x and y values generate negative longitudes and latitudes respectively, implying that the coordinates are being reversed during the transform.  I have tried the code sample, and my calculated values do seem to match those in the post.</p>\n<p>Examining the <a data-is-external-link=\"true\" href=\"https://bitbucket.org/osrf/gazebo/src/48039241c95fcf879ef5861e5ca66efcd4f22e6c/gazebo/common/SphericalCoordinates.cc?at=default&amp;fileviewer=file-view-default#SphericalCoordinates.cc-313\" rel=\"nofollow\">linked source code</a>, which shows the local to spherical transformation of both coordinates and velocities, the SphericalCoordinates class appears to start by reversing the sign of the x and y components.  This could be the source of the coordinate reversal.  Checking the ignition version of the code it seems identical, implying that later version of gazebo that use the ignition library are also likely to be affected.  </p>\n<p>Regards,</p>\n<p>Jonathan.</p>", "type": "rendered"}, "created_on": "2019-06-14T23:43:27.949826+00:00", "user": {"display_name": "Jonathan Wheare", "uuid": "{65043b9b-c505-4efe-852a-3d2393a0ee80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B65043b9b-c505-4efe-852a-3d2393a0ee80%7D"}, "html": {"href": "https://bitbucket.org/%7B65043b9b-c505-4efe-852a-3d2393a0ee80%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/initials/JW-2.png"}}, "nickname": "Jonathan Wheare", "type": "user", "account_id": "5b9791e8a9fd6d2c834b5864"}, "updated_on": null, "type": "issue_comment", "id": 52589397}
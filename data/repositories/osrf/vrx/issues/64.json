{"priority": "minor", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/vrx.json"}, "html": {"href": "#!/osrf/vrx"}, "avatar": {"href": "data/bytebucket.org/ravatar/{e278ca38-7edb-4e62-b785-46dff5617d98}ts=2274605"}}, "type": "repository", "name": "vrx", "full_name": "osrf/vrx", "uuid": "{e278ca38-7edb-4e62-b785-46dff5617d98}"}, "links": {"attachments": {"href": "data/repositories/osrf/vrx/issues/64/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/vrx/issues/64.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/vrx/issues/64/watch"}, "comments": {"href": "data/repositories/osrf/vrx/issues/64/comments_page=1.json"}, "html": {"href": "#!/osrf/vrx/issues/64/possible-frame-error-in-simulated-gps"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/vrx/issues/64/vote"}}, "reporter": {"display_name": "Jonathan Wheare", "uuid": "{65043b9b-c505-4efe-852a-3d2393a0ee80}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B65043b9b-c505-4efe-852a-3d2393a0ee80%7D"}, "html": {"href": "https://bitbucket.org/%7B65043b9b-c505-4efe-852a-3d2393a0ee80%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/initials/JW-2.png"}}, "nickname": "Jonathan Wheare", "type": "user", "account_id": "5b9791e8a9fd6d2c834b5864"}, "title": "Possible frame error in simulated GPS velocity generation", "component": null, "votes": 0, "watches": 1, "content": {"raw": "Hi There,\r\n\r\nI have been experimenting with the state estimation in the VRX simulation, and believe I have found a frame error in the generation of velocity information by the simulated GPS sensor.\r\nROS and Gazebo both appear to use a right-handed East-North-Up coordinate system, defined in [REP-015](http://www.ros.org/reps/rep-0105.html#map) and also specified in the ```spherical_coordinates``` tag of the sand island world.\r\n\r\nHowever, if a wam-v is placed in the VRX world, aligned with the x-axis and driven forwards, the world frame velocity reported by the ```fix_velocity``` topic will be negative y, Similarly, when aligned with the y-axis, the velocity will be positive x.  Examination of the simulated GPS sensor in ```wamv_gps.xacro``` shows that the ```referenceHeading``` tag has been used to rotate the GPS frame to align the latitude and longitude values with the ENU frame.\r\n\r\nThis may be caused by the way that the underlying hector_gazebo [gps plugin](https://github.com/tu-darmstadt-ros-pkg/hector_gazebo/blob/kinetic-devel/hector_gazebo_plugins/src/gazebo_ros_gps.cpp)  operates.  With a zero ```referenceHeading```, the plugin appears to use a North-West-Up frame to generate latitude and longitude.  Rotating this into East-North-Up causes the velocity data to be similarly rotated.\r\n\r\nSteps to reproduce;\r\n\r\nSelect sensor wamv in the ```vmrc.launch``` file, then run the keydrive examples.\r\n\r\n```rostopic echo /gps/fix_velocity```\r\n\r\nUse keydrive to move the wamv forward.  ```fix_velocity``` should show a negative y value as the largest component.\r\n\r\nRotate the wam-v to align with the y-axis and move the wam-v forward.   ```fix_velocity``` should show a positive x value as the largest component.\r\n\r\nRegards,\r\nJonathan Wheare.", "markup": "markdown", "html": "<p>Hi There,</p>\n<p>I have been experimenting with the state estimation in the VRX simulation, and believe I have found a frame error in the generation of velocity information by the simulated GPS sensor.\nROS and Gazebo both appear to use a right-handed East-North-Up coordinate system, defined in <a data-is-external-link=\"true\" href=\"http://www.ros.org/reps/rep-0105.html#map\" rel=\"nofollow\">REP-015</a> and also specified in the <code>spherical_coordinates</code> tag of the sand island world.</p>\n<p>However, if a wam-v is placed in the VRX world, aligned with the x-axis and driven forwards, the world frame velocity reported by the <code>fix_velocity</code> topic will be negative y, Similarly, when aligned with the y-axis, the velocity will be positive x.  Examination of the simulated GPS sensor in <code>wamv_gps.xacro</code> shows that the <code>referenceHeading</code> tag has been used to rotate the GPS frame to align the latitude and longitude values with the ENU frame.</p>\n<p>This may be caused by the way that the underlying hector_gazebo <a data-is-external-link=\"true\" href=\"https://github.com/tu-darmstadt-ros-pkg/hector_gazebo/blob/kinetic-devel/hector_gazebo_plugins/src/gazebo_ros_gps.cpp\" rel=\"nofollow\">gps plugin</a>  operates.  With a zero <code>referenceHeading</code>, the plugin appears to use a North-West-Up frame to generate latitude and longitude.  Rotating this into East-North-Up causes the velocity data to be similarly rotated.</p>\n<p>Steps to reproduce;</p>\n<p>Select sensor wamv in the <code>vmrc.launch</code> file, then run the keydrive examples.</p>\n<p><code>rostopic echo /gps/fix_velocity</code></p>\n<p>Use keydrive to move the wamv forward.  <code>fix_velocity</code> should show a negative y value as the largest component.</p>\n<p>Rotate the wam-v to align with the y-axis and move the wam-v forward.   <code>fix_velocity</code> should show a positive x value as the largest component.</p>\n<p>Regards,\nJonathan Wheare.</p>", "type": "rendered"}, "assignee": {"display_name": "Brian Bingham", "uuid": "{9cdea257-248f-486e-8858-49d8485a916f}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9cdea257-248f-486e-8858-49d8485a916f%7D"}, "html": {"href": "https://bitbucket.org/%7B9cdea257-248f-486e-8858-49d8485a916f%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1/7a690884-fc47-4bca-9c2b-baecee4d3dc9/128"}}, "nickname": "brian_bingham", "type": "user", "account_id": "557058:6c52d6e5-77e0-41a8-8b6e-cb9462f4d5f1"}, "state": "resolved", "version": null, "edited_on": null, "created_on": "2019-02-24T04:48:02.730212+00:00", "milestone": null, "updated_on": "2019-07-01T16:29:02.178294+00:00", "type": "issue", "id": 64}